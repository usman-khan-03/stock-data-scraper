import os
import yfinance as yf
import pandas as pd

# Check the current directory
print("Current directory:", os.getcwd())

def get_stock_data(stock_symbol):
    # Download stock data using yfinance
    stock_data = yf.download(stock_symbol, start="1900-01-01", end="2024-01-01", interval="1d")
    return stock_data

def save_to_csv(df, stock_symbol):
    file_name = f'{stock_symbol}_historical_data.csv'
    df.to_csv(file_name)
    print(f'Data saved to {file_name}')

if __name__ == "__main__":
    stock_symbols = ['A', 'AAL', 'AAP', 'AAPL', 'ABBV', 'ABMD', 'ABT', 'ACN', 'ADBE', 'ADI', 'ADM', 'ADP', 'ADSK', 'AEE', 'AEP', 'AES', 'AFL', 'AIG', 'AIZ', 'AJG', 'AKAM', 'ALB', 'ALGN', 'ALK', 'ALL', 'ALLE', 'AMAT', 'AMCR', 'AMD', 'AME', 'AMGN', 'AMP', 'AMT', 'AMZN', 'ANET', 'ANSS', 'AON', 'AOS', 'APA', 'APD', 'APH', 'APTV', 'ARE', 'ATO', 'AVB', 'AVGO', 'AVY', 'AWK', 'AXP', 'AZO', 'BA', 'BAC', 'BALL', 'BAX', 'BBWI', 'BBY', 'BDX', 'BEN', 'BF-B', 'BIIB', 'BIO', 'BK', 'BKNG', 'BKR', 'BLK', 'BMY', 'BR', 'BRK-B', 'BRO', 'BSX', 'BWA', 'BXP', 'C', 'CAG', 'CAH', 'CARR', 'CAT', 'CB', 'CBOE', 'CBRE', 'CCI', 'CCL', 'CDNS', 'CDW', 'CE', 'CF', 'CFG', 'CHD', 'CHRW', 'CHTR', 'CI', 'CINF', 'CL', 'CLX', 'CMA', 'CMCSA', 'CME', 'CMG', 'CMI', 'CMS', 'CNC', 'CNP', 'COF', 'COO', 'COP', 'COST', 'CPB', 'CPRT', 'CPT', 'CRL', 'CRM', 'CSCO', 'CSX', 'CTAS', 'CTLT', 'CTRA', 'CTSH', 'CTVA', 'CVS', 'CVX', 'D', 'DAL', 'DD', 'DE', 'DFS', 'DG', 'DGX', 'DHI', 'DHR', 'DIS', 'DLR', 'DLTR', 'DOV', 'DOW', 'DPZ', 'DRI', 'DTE', 'DUK', 'DVA', 'DVN', 'DXC', 'DXCM', 'EA', 'EBAY', 'ECL', 'ED', 'EFX', 'EIX', 'EL', 'EMN', 'EMR', 'ENPH', 'EOG', 'EPAM', 'EQIX', 'EQR', 'ES', 'ESS', 'ETN', 'ETR', 'EVRG', 'EW', 'EXC', 'EXPD', 'EXPE', 'EXR', 'F', 'FANG', 'FAST', 'FCX', 'FDX', 'FE', 'FFIV', 'FIS', 'FISV', 'FITB', 'FMC', 'FOX', 'FOXA', 'FRT', 'FTNT', 'FTV', 'GD', 'GE', 'GILD', 'GIS', 'GL', 'GLW', 'GM', 'GNRC', 'GOOG', 'GOOGL', 'GPC', 'GPN', 'GRMN', 'GS', 'GWW', 'HAL', 'HAS', 'HBAN', 'HBI', 'HCA', 'HD', 'HES', 'HIG', 'HII', 'HLT', 'HOG', 'HOLX', 'HON', 'HPE', 'HPQ', 'HRL', 'HSIC', 'HST', 'HSY', 'HUM', 'HWM', 'IBM', 'ICE', 'IDXX', 'IEX', 'IFF', 'ILMN', 'INCY', 'INTC', 'INTU', 'IP', 'IPG', 'IPGP', 'IQV', 'IR', 'IRM', 'ISRG', 'IT', 'ITW', 'IVZ', 'J', 'JBHT', 'JCI', 'JKHY', 'JNJ', 'JNPR', 'JPM', 'K', 'KEY', 'KEYS', 'KHC', 'KIM', 'KLAC', 'KMB', 'KMI', 'KO', 'KR', 'L', 'LDOS', 'LEN', 'LIN', 'LITE', 'LKQ', 'LLY', 'LMT', 'LNC', 'LNT', 'LOW', 'LRCX', 'LUMN', 'LUV', 'LVS', 'LW', 'LYB', 'LYV', 'MA', 'MAA', 'MAR', 'MAS', 'MCD', 'MCHP', 'MCK', 'MCO', 'MDLZ', 'MDT', 'MET', 'META', 'MGM', 'MHK', 'MKC', 'MKTX', 'MLM', 'MMC', 'MMM', 'MNST', 'MO', 'MOS', 'MPC', 'MPWR', 'MRK', 'MRO', 'MS', 'MSCI', 'MSFT', 'MSI', 'MTB', 'MTD', 'MU', 'NCLH', 'NDAQ', 'NDSN', 'NEE', 'NEM', 'NFLX', 'NI', 'NKE', 'NOC', 'NOW', 'NRG', 'NSC', 'NTAP', 'NTRS', 'NUE', 'NVDA', 'NVR', 'NWL', 'NWS', 'NWSA', 'NXPI', 'O', 'ODFL', 'OKE', 'OMC', 'ORCL', 'ORLY', 'OTIS', 'OXY', 'PARA', 'PAYC', 'PAYX', 'PCAR', 'PEG', 'PEP', 'PFE', 'PFG', 'PG', 'PGR', 'PH', 'PHM', 'PKG', 'PLD', 'PLTR', 'PM', 'PNC', 'PNR', 'PNW', 'POOL', 'PPG', 'PPL', 'PRGO', 'PRU', 'PSA', 'PSX', 'PTC', 'PVH', 'PWR', 'PYPL', 'QCOM', 'QRVO', 'RCL', 'REG', 'REGN', 'RF', 'RHI', 'RJF', 'RL', 'RMD', 'ROK', 'ROL', 'ROP', 'ROST', 'RSG', 'RTX', 'SBAC', 'SBNY', 'SBUX', 'SCHW', 'SEE', 'SHW', 'SIVB', 'SJM', 'SLB', 'SNA', 'SNPS', 'SO', 'SPG', 'SPGI', 'SRE', 'STE', 'STT', 'STX', 'STZ', 'SWK', 'SWKS', 'SYF', 'SYK', 'SYY', 'T', 'TAP', 'TDG', 'TDY', 'TECH', 'TEL', 'TER', 'TFC', 'TFX', 'TGT', 'TJX', 'TMO', 'TMUS', 'TPR', 'TRMB', 'TROW', 'TRV', 'TSCO', 'TSLA', 'TSN', 'TT', 'TTWO', 'TXN', 'TXT', 'TYL', 'UAL', 'UDR', 'UHS', 'ULTA', 'UNH', 'UNP', 'UPS', 'URI', 'USB', 'V', 'VFC', 'VLO', 'VMC', 'VNO', 'VRSK', 'VRSN', 'VRTX', 'VTR', 'VTRS', 'VZ', 'WAB', 'WAT', 'WBA', 'WDC', 'WEC', 'WELL', 'WFC', 'WHR', 'WM', 'WMB', 'WMT', 'WRB', 'WRK', 'WST', 'WTW', 'WY', 'WYNN', 'XEL', 'XOM', 'XRAY', 'XYL', 'YUM', 'ZBH', 'ZBRA', 'ZION', 'ZTS', '1332.T', '1605.T', '1721.T', '1801.T', '1802.T', '1803.T', '1808.T', '1812.T', '1925.T', '1928.T', '1963.T', '2001.T', '2269.T', '2282.T', '600000.SS', '600004.SS', '600006.SS', '600007.SS', '600008.SS', '600009.SS', '600010.SS', '600011.SS', '600012.SS', '600015.SS', '600016.SS', '600017.SS', '600018.SS', '600019.SS', '600020.SS', '600021.SS', '600022.SS', '600023.SS', '600025.SS', '600026.SS', 'AD.AS', 'AGN.AS', 'AKZA.AS', 'ASML.AS', 'GLPG.AS', 'HEIA.AS', 'IMCD.AS', 'INGA.AS', 'KPN.AS', 'MT.AS', 'NN.AS', 'PHIA.AS', 'RAND.AS', 'REN.AS', 'SBMO.AS', 'UNA.AS', '0001.HK', '0002.HK', '0003.HK', '0004.HK', '0005.HK', '0006.HK', '0008.HK', '0011.HK', '0012.HK', '0016.HK', '0017.HK', '0019.HK', '0023.HK', '0027.HK', '0066.HK', '0101.HK', '0388.HK', '0688.HK', '0700.HK', '0762.HK', '3IN.L', 'AAL.L', 'ABF.L', 'ADM.L', 'AHT.L', 'ANTO.L', 'AUTO.L', 'AV.L', 'AZN.L', 'BA.L', 'BARC.L', 'BATS.L', 'BDEV.L', 'BKG.L', 'BLND.L', 'BME.L', 'BNZL.L', 'BP.L', 'BRBY.L', 'BT-A.L', 'CCH.L', 'CPG.L', 'CRH.L', 'CRDA.L', 'DCC.L', 'DGE.L', 'DLG.L', 'EXPN.L', 'FERG.L', 'FLTR.L', 'GLEN.L', 'GSK.L', 'HLMA.L', 'HSBA.L', 'IAG.L', 'ICP.L', 'IHG.L', 'III.L', 'IMB.L', 'INF.L', 'ITRK.L', 'JD.L', 'JET.L', 'KGF.L', 'LAND.L', 'LGEN.L', 'LLOY.L', 'LSE.L', 'MNDI.L', 'MNG.L', 'MRO.L', 'MRW.L', 'NG.L', 'NXT.L', 'OCDO.L', 'PHNX.L', 'POLY.L', 'PRU.L', 'PSN.L', 'PSON.L', 'RB.L', 'RDSA.L', 'RDSB.L', 'REL.L', 'RIO.L', 'RR.L', 'RTO.L', 'SBRY.L', 'SDR.L', 'SGE.L', 'SGRO.L', 'SHEL.L', 'SMDS.L', 'SMIN.L', 'SMT.L', 'SN.L', 'SPX.L', 'SSE.L', 'STAN.L', 'STJ.L', 'SVT.L', 'TSCO.L', 'TW.L', 'ULVR.L', 'UU.L', 'VOD.L', 'WEIR.L', 'WTB.L', 'WPP.L', 'RELIANCE.BO', 'TCS.BO', 'HDFCBANK.BO', 'HINDUNILVR.BO', 'INFY.BO', 'ICICIBANK.BO', 'KOTAKBANK.BO', 'SBIN.BO', 'AXISBANK.BO', 'BAJFINANCE.BO', 'HCLTECH.BO', 'ITC.BO', 'LT.BO', 'BHARTIARTL.BO', 'ASIANPAINT.BO', 'MARUTI.BO', 'TATASTEEL.BO', 'M&M.BO', 'SUNPHARMA.BO', 'NTPC.BO', 'POWERGRID.BO', 'ULTRACEMCO.BO', 'HDFCLIFE.BO', 'NESTLEIND.BO', 'TECHM.BO', 'ADS.DE', 'ALV.DE', 'BAS.DE', 'BAYN.DE', 'BMW.DE', 'CON.DE', '1COV.DE', 'DB1.DE', 'DBK.DE', 'DTE.DE', 'DWNI.DE', 'EOAN.DE', 'FRE.DE', 'FME.DE', 'HEI.DE', 'HEN3.DE', 'IFX.DE', 'LIN.DE', 'MRK.DE', 'MUV2.DE', 'PUM.DE', 'RWE.DE', 'SAP.DE', 'SIE.DE', 'VOW3.DE', 'VNA.DE', 'MTX.DE', 'ZAL.DE', 'ADEN.SW', 'NESN.SW', 'NOVN.SW', 'ROG.SW', 'SCMN.SW', 'SGSN.SW', 'SIKA.SW', 'SLHN.SW', 'STMN.SW', '005930.KS', '000660.KS', '005935.KS', '035420.KS', '051910.KS', '207940.KS', '005380.KS', '068270.KS', '012330.KS', '051900.KS', 'ANZ.AX', 'BHP.AX', 'CBA.AX', 'CSL.AX', 'MQG.AX', 'NAB.AX', 'RIO.AX', 'WBC.AX', 'WES.AX', 'WOW.AX', '2330.TW', '2317.TW', '2454.TW', '2303.TW', '2412.TW', '1301.TW', '2882.TW', '2891.TW', '2308.TW', '2881.TW', '^BVSP', 'PETR3.SA', 'PETR4.SA', 'VALE3.SA', 'ITUB4.SA', 'BBDC3.SA', 'BBDC4.SA', 'ABEV3.SA', 'BBAS3.SA', 'B3SA3.SA', '^IBEX', 'SAN.MC', 'TEF.MC', 'BBVA.MC', 'ITX.MC', 'IBE.MC', 'AMS.MC', 'GRF.MC', 'ENG.MC', 'SBER.ME', 'LKOH.ME', 'GAZP.ME', 'YNDX.ME', 'NVTK.ME', 'ROSN.ME', 'GMKN.ME', 'VTBR.ME', 'ALRS.ME', '2222.SR', '4001.SR', '2010.SR', '1810.SR', '1050.SR', '3002.SR', '2280.SR', '2282.SR', '2070.SR', '^STI', 'D05.SI', 'C6L.SI', 'U11.SI', 'O39.SI', 'C09.SI', 'Z74.SI', 'C09.SI', 'C38U.SI', '^MXX', 'FEMSAUBD.MX', 'GMEXICOB.MX', 'GFINBURO.MX', 'WALMEX.MX', 'KIMBERA.MX', 'CEMEXCPO.MX', 'ALSEA.MX', 'GAPB.MX', '^JKSE', 'BBCA.JK', 'TLKM.JK', 'BBRI.JK', 'ASII.JK', 'UNVR.JK', 'BMRI.JK', 'HMSP.JK', 'KLBF.JK', 'BBNI.JK', 'SM.PS', 'BPI.PS', 'BDO.PS', 'TEL.PS', 'JGS.PS', 'AC.PS', 'ALI.PS', 'SMPH.PS', 'URC.PS', '^KLSE', 'IOICORP.KL', 'SIMEPLT.KL', 'AXIATA.KL', '^MERV', 'GGAL.BA', 'YPFD.BA', 'BMA.BA', 'PAMP.BA', 'TECO2.BA', 'TXAR.BA', 'LOMA.BA', 'EDN.BA', 'SUPV.BA', '^IPSA', 'BSANTANDER.SN', 'FALABELLA.SN', 'COPEC.SN', 'SQM-B.SN', 'ENELCHILE.SN', 'CENCOSUD.SN', 'CHILE.SN', 'CMPC.SN', 'BCI.SN', 'PFBCOLOM.CL', 'ECOPETROL.CL', 'PFAVAL.CL', 'GRUPOSURA.CL', 'GRUPOARGOS.CL', 'EXITO.CL', 'CEMARGOS.CL', 'BVC.CL', '^NZ50', 'AIA.NZ', 'ATM.NZ', 'ANZ.NZ', 'ARG.NZ', 'CEN.NZ', 'FPH.NZ', 'FBU.NZ', 'GNE.NZ', 'IFT.NZ', '^OBX', 'EQNR.OL', 'DNB.OL', 'NHY.OL', 'TEL.OL', 'ORK.OL', 'YAR.OL', 'SUBC.OL', 'AKRBP.OL', 'MOWI.OL', '^WIG20', 'PKN.WA', 'PKO.WA', 'PEO.WA', 'PZU.WA', 'KGH.WA', 'LPP.WA', 'DNP.WA', 'CCC.WA', 'CDR.WA', '^ISEQ', 'GL9.IR', 'KRZ.IR', 'RYA.IR', '^ATG', 'ALPHA.AT', 'ETE.AT', 'EUROB.AT', 'PPC.AT', 'OPAP.AT', 'TITC.AT', 'MOH.AT', 'ELPE.AT', 'MYTIL.AT', 'AKBNK.IS', 'GARAN.IS', 'ISCTR.IS', 'THYAO.IS', 'PETKM.IS', 'ASELS.IS', 'KRDMD.IS', 'TUPRS.IS', 'EREGL.IS', '^ATX', 'ANDR.VI', 'OMV.VI', 'VOE.VI', 'TKA.VI', 'RBI.VI', 'CAI.VI', 'VER.VI', 'SBO.VI', 'AMS.VI', 'NBK.KW', 'ZAIN.KW', 'KFIN.KW', 'BOUBYAN.KW', 'MABANEE.KW', 'KFH.KW', '^BAX', 'BATELCO.BH', 'BBK.BH', 'AUB.BH', 'NBB.BH', 'GFH.BH', 'ALBH.BH', 'BCFC.BH', 'BARKA.BH', '^MASI', '^CSE', 'OGDC.KA', 'HBL.KA', 'MCB.KA', 'UBL.KA', 'ENGRO.KA', 'PPL.KA', 'LUCK.KA', 'FFC.KA', 'POL.KA', 'PSO.KA', 'HUBC.KA', 'BAHL.KA', 'MARI.KA', 'DGKC.KA', 'NBP.KA', 'INDU.KA', 'FFBL.KA', 'SNGP.KA', 'KAPCO.KA', 'NRL.KA', 'MTL.KA', 'ATRL.KA', 'SSGC.KA', 'EFERT.KA', 'AKBL.KA', 'SYS.KA', 'FCCL.KA', 'EPCL.KA', 'LOTCHEM.KA', 'GWLC.KA', 'INIL.KA', 'PKGS.KA', 'KOHC.KA', 'PAEL.KA', 'DOL.KA', 'MUGHAL.KA', 'NETSOL.KA', 'KTML.KA', 'SSGC.KA', 'PIOC.KA', 'LPL.KA', 'GATM.KA'
    ]
    for symbol in stock_symbols:
        df = get_stock_data(symbol)
        if not df.empty:
            save_to_csv(df, symbol)
            print(f"Successfully scraped data for {symbol}")
        else:
            print(f"No data to save for {symbol}")

